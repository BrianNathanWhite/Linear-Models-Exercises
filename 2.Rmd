---
title: "STOR 664 HW 2"
author: "Brian N. White"
date: "9/9/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Problem 20

```{r}
library(data.table)
dmark <- fread('http://rls.sites.oasis.unc.edu/faculty/rs/source/Data/dmark.dat')
#pull in data from website
head(dmark)

colnames(dmark)[] <- c("week", "mark", "pound")
#give variables descriptive names
colnames(dmark)

attach(dmark)
#column names of mydat recognized independently
```

$\textbf{(a)}$

Note, there is strong visual evidence of autocorrelation in the time series.
```{r}
par(mfrow=c(2, 2))
plot(mark~week)
plot(pound~week)
plot(pound~mark)
```
$\textbf{(b)}$

Assume the individaul weekly observaions are independent. The linear regression equation $\hat y_{i}=\hat\beta_{0}+\hat\beta_{1}x_{i}$ is computed via the code below. A point estimate for $\hat\beta_{1}$ is approximately $-2.9$ with a 90% confidence interval of $[-5.12, -0.69]$. Consider the following hypotheses: $H_{0}: \beta_{1}=0$ vs $H_{1}: \beta_{1}\neq{0}$ with $\alpha=0.1$. Observe that $0$ is not an element of $[-5.12, -0.69]$, the 90% confidence interval for $\beta_{1}$. Thus, $H_{0}$ is rejected; there is evidence to suggest that $\beta_{1}\neq{0}$.
```{r}
mp_lm <- lm(pound~mark)
summary(mp_lm)
confint(mp_lm, level=0.90)

plot(pound~mark)
abline(mp_lm, col="blue")
```
$\textbf{(c)}$

Inspection of the first 10 autocorrelation coeffecients are computed from the residuals via the acf(.) command. Inspection of these, together with the heuristic $\frac{2}{\sqrt{n}}=\frac{2}{\sqrt{51}}\approx0.28$, suggests that the first 8 autocorrelations are statistically significant. There is clearly evidence that autocorrelation is present. A more precise test, such as the Durbin-Watson could be performed to confirm this heuristic argument.
```{r}
mp_residuals <- mp_lm$residuals #the residuals of the linear model in question
mp_ac <- acf(mp_residuals, lag.max=10) #the first 10 serial correlations are computed with approximate 95% error bounds if the true time series is independent.
mp_ac

heuristic<-2/sqrt(51) #the heursitic used to determine statistical significance of the autocorrelations
which(abs(mp_ac$acf)>heuristic) #the indices of the autocorrelations that are statistically significant.

#Code to compute the Durbin Watson test statistic
dw_num <- rep(0,50)
for(i in 2:51){
  dw_num[i] <- (mp_residuals[i]-mp_residuals[i-1])^2
}

D=sum(dw_num)/sum(mp_residuals^2)
D
```
$\textbf{(d)}$
```{r}

```

### Problem 21

```{r}
marathon <- fread('http://rls.sites.oasis.unc.edu/faculty/rs/source/Data/marathon.dat')
#pull in data from website
head(marathon)

colnames(marathon)[] <- c("length", "count")
#give variables descriptive names
colnames(marathon)

attach(marathon)
#column names of mydat recognized independently
```

